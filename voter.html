<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voter — Hercule Project</title>
  <!-- On s'appuie sur ta feuille de style globale -->
  <link rel="stylesheet" href="/style.css">
  <meta name="description" content="Vote, partage et gagne des Jetons d’Hercule à échanger contre des récompenses." />
</head>
<body>
  <!-- Header commun du site -->
  <div id="site-header" data-header="/header-root.html"></div>
  <script src="/assets/js/header.js"></script>

  <main class="wrap" style="padding-bottom:72px">
    <!-- HERO -->
    <header class="grid cols-2" style="align-items:center;gap:22px;margin-top:16px">
      <div>
        <div class="badge">Page communauté</div>
        <h1>Soutiens le <span class="accent">Hercule Project</span> 💪</h1>
        <p class="lead">Vote pour nous, partage l’aventure et gagne des <strong>Jetons d’Hercule</strong> à échanger contre des récompenses.</p>
        <div class="row" style="margin-top:12px;gap:10px;flex-wrap:wrap">
          <div class="stat">🔥 Votes ce mois‑ci : <span id="voteMonth">0</span></div>
          <div class="stat">🎖️ Objectif : <span id="goal">500</span></div>
          <div class="stat">🏆 Top supporters : <span id="top">—</span></div>
        </div>
        <div class="goal" style="margin-top:12px"><i id="bar"></i></div>
        <p class="tiny">Astuce : chaque <strong>vote + partage</strong> = bonus de jetons 💎</p>
      </div>
      <figure class="imgbox">
        <img src="/assets/img/jetons-hercule.png" alt="Jetons d’Hercule — illustration" loading="lazy">
      </figure>
    </header>

    <!-- 3 BLOCS PRINCIPAUX -->
    <section class="grid cols-3" style="margin-top:18px">
      <!-- 1) Voter -->
      <article class="card">
        <h3>1) Voter</h3>
        <p class="muted">Choisis un site de vote ci‑dessous, clique et dépose ton vote.</p>
        <div class="row" style="margin-top:10px;gap:10px;flex-wrap:wrap">
          <!-- Remplace les href par tes liens réels -->
          <a class="btn" href="https://exemple-topsite-1.com" target="_blank" rel="noopener">⭐ Voter (TopSite 1)</a>
          <a class="btn" href="https://exemple-topsite-2.com" target="_blank" rel="noopener">⭐ Voter (TopSite 2)</a>
          <a class="btn" href="https://exemple-topsite-3.com" target="_blank" rel="noopener">⭐ Voter (TopSite 3)</a>
        </div>
        <p class="tiny">Après ton vote, reviens ici pour partager et récupérer tes jetons.</p>
      </article>

      <!-- 2) Partager -->
      <article class="card">
        <h3>2) Partager l’aventure</h3>
        <p class="muted">Un message pré‑rempli sera proposé. Si ton navigateur ne le permet pas, on copie le texte pour toi.</p>
        <button id="shareBtn" class="btn primary" style="margin-top:4px">📣 Partager & gagner des jetons</button>
        <p id="shareState" class="tiny" style="margin-top:8px"></p>
        <div class="note" style="margin-top:10px">
          <p class="tiny"><strong>Gain type :</strong> Vote = +5 jetons · Vote + Partage = +15 jetons.</p>
        </div>
      </article>

      <!-- 3) Récompenses -->
      <article class="card">
        <h3>Récompenses</h3>
        <table class="table">
          <thead><tr><th>Récompense</th><th>Coût</th></tr></thead>
          <tbody>
            <tr><td>Autocollant</td><td>300 jetons</td></tr>
            <tr><td>T‑shirt exclusif</td><td>1000 jetons</td></tr>
            <tr><td>Médaille collector</td><td>1500 jetons</td></tr>
            <tr><td>Réduction de 5 € sur un niveau</td><td>500 jetons</td></tr>
          </tbody>
        </table>
        <p class="tiny">Les récompenses physiques sont en quantité limitée.</p>
      </article>
    </section>

    <!-- Comment gagner / dépenser -->
    <section class="grid cols-2" style="margin-top:16px;align-items:start">
      <article class="card">
        <h3>Comment gagner des jetons</h3>
        <ul class="list">
          <li>Voter → <strong>+5</strong> jetons</li>
          <li>Voter + partager → <strong>+15</strong> jetons</li>
          <li>Participer à un défi → <strong>+50</strong> jetons</li>
          <li>Top 10 mensuel → <strong>+100</strong> jetons</li>
          <li>Parrainage validé → <strong>+200</strong> jetons</li>
        </ul>
      </article>
      <article class="card">
        <h3>Comment dépenser</h3>
        <ul class="list">
          <li><span class="check">✔</span> Badges (50 jetons)</li>
          <li><span class="check">✔</span> Réductions internes (150 jetons)</li>
          <li><span class="check">✔</span> Boost XP (100 jetons)</li>
          <li><span class="check">✔</span> Cosmétiques virtuels (75 jetons)</li>
        </ul>
      </article>
    </section>

    <footer style="margin-top:28px">
      <p class="tiny">En votant/partageant, tu acceptes nos <a href="/cgu.html" class="accent">CGU</a>. Anti‑triche : validations automatiques + contrôle manuel ponctuel.</p>
    </footer>
  </main>

  <!-- JS spécifique à la page (léger, compatible avec ton style global) -->
  <script>
    // --------- MOCK compteur votes (à brancher sur ton backend) ----------
    const monthVotes = 257;           // TODO: valeur issue de ton API
    const monthGoal  = 500;           // objectif
    const topNames   = ["Léo","Nora","Axel"]; // top supporters

    // Rendus
    document.getElementById('voteMonth').textContent = monthVotes;
    document.getElementById('goal').textContent = monthGoal;
    document.getElementById('top').textContent = topNames.join(", ");
    const pct = Math.min(100, Math.round((monthVotes / monthGoal) * 100));
    const bar = document.getElementById('bar');
    if (bar) bar.style.width = pct + "%";

    // --------- Partage (Web Share API + fallback copy) -------------------
    const shareBtn = document.getElementById('shareBtn');
    const shareMsg = "💪 J’ai rejoint l’aventure du Hercule Project ! Toi aussi viens relever les défis 🔥 #HerculeProject";
    const shareUrl = location.origin || "https://ton-domaine.fr";

    async function doShare(){
      const state = document.getElementById('shareState');
      try{
        if (navigator.share){
          await navigator.share({ title:"Hercule Project", text:shareMsg, url:shareUrl });
          state.textContent = "Merci ! Partage effectué. +15 jetons seront crédités ✨";
        } else {
          await navigator.clipboard.writeText(`${shareMsg} ${shareUrl}`);
          state.textContent = "Message copié ! Colle‑le sur tes réseaux et récupère +15 jetons ✨";
        }
        // TODO: fetch('/api/credit-share', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({kind:'share_social'})})
      }catch(e){
        state.textContent = "Partage annulé.";
      }
    }
    if (shareBtn) shareBtn.addEventListener('click', doShare);

    // --------- Activer l'onglet actif dans le header ---------------------
    // Si ton header-root.html utilise <a href="/voter.html">, le script header.js
    // peut gérer l'état actif automatiquement. Sinon :
    document.addEventListener('DOMContentLoaded', ()=>{
      const link = document.querySelector('a[href$="/voter.html"]');
      if(link) link.classList.add('active');
    });
  </script>
</body>
</html>
